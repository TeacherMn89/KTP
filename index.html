<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ö–¢–ü</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .form-section {
            padding: 40px;
            background: #f8fafc;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .form-group {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .form-group h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
            min-width: 200px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .results-section {
            padding: 40px;
            display: none;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .results-title {
            color: #2d3748;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: #38a169;
            transform: translateY(-1px);
        }

        .export-btn.excel {
            background: #22c55e;
        }

        .export-btn.excel:hover {
            background: #16a34a;
        }

        .export-btn.docx {
            background: #3b82f6;
        }

        .export-btn.docx:hover {
            background: #2563eb;
        }

        .ktp-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .ktp-table th {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 1rem;
        }

        .ktp-table td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
            vertical-align: top;
        }

        .ktp-table tr:hover {
            background: #f7fafc;
        }

        .lesson-number {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin: 0 auto;
        }

        .holiday-row {
            background: #fed7d7 !important;
            color: #c53030;
            font-style: italic;
        }

        .weekend-row {
            background: #e6fffa !important;
            color: #319795;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-weight: 600;
        }

        .icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .results-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .export-buttons {
                justify-content: center;
            }
            
            .ktp-table {
                font-size: 14px;
            }
            
            .ktp-table th,
            .ktp-table td {
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ö–¢–ü</h1>
            <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ-—Ç–µ–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Å–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤</p>
        </div>

        <div class="form-section">
            <div class="form-grid">
                <div class="form-group">
                    <h3><span class="icon">üéì</span> –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h3>
                    <label for="subject">–ü—Ä–µ–¥–º–µ—Ç:</label>
                    <select id="subject">
                        <option value="">–û–±–µ—Ä—ñ—Ç—å –ø—Ä–µ–¥–º–µ—Ç</option>
                        <option value="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞</option>
                        <option value="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞</option>
                        <option value="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
                        <option value="–ê–ª–≥–µ–±—Ä–∞">–ê–ª–≥–µ–±—Ä–∞</option>
                        <option value="–ì–µ–æ–º–µ—Ç—Ä—ñ—è">–ì–µ–æ–º–µ—Ç—Ä—ñ—è</option>
                        <option value="–§—ñ–∑–∏–∫–∞">–§—ñ–∑–∏–∫–∞</option>
                        <option value="–•—ñ–º—ñ—è">–•—ñ–º—ñ—è</option>
                        <option value="–ë—ñ–æ–ª–æ–≥—ñ—è">–ë—ñ–æ–ª–æ–≥—ñ—è</option>
                        <option value="–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è">–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è</option>
                        <option value="–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏">–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏</option>
                        <option value="–í—Å–µ—Å–≤—ñ—Ç–Ω—è —ñ—Å—Ç–æ—Ä—ñ—è">–í—Å–µ—Å–≤—ñ—Ç–Ω—è —ñ—Å—Ç–æ—Ä—ñ—è</option>
                        <option value="–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞">–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞</option>
                        <option value="–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞">–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</option>
                        <option value="–¢—Ä—É–¥–æ–≤–µ –Ω–∞–≤—á–∞–Ω–Ω—è">–¢—Ä—É–¥–æ–≤–µ –Ω–∞–≤—á–∞–Ω–Ω—è</option>
                        <option value="–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞">–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞</option>
                        <option value="–ú–∏—Å—Ç–µ—Ü—Ç–≤–æ">–ú–∏—Å—Ç–µ—Ü—Ç–≤–æ</option>
                        <option value="–Ü–Ω—à–∏–π">–Ü–Ω—à–∏–π –ø—Ä–µ–¥–º–µ—Ç</option>
                    </select>

                    <label for="customSubject" id="customSubjectLabel" style="display: none;">–ù–∞–∑–≤–∞ –ø—Ä–µ–¥–º–µ—Ç—É:</label>
                    <input type="text" id="customSubject" style="display: none;" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –ø—Ä–µ–¥–º–µ—Ç—É">

                    <label for="grade">–ö–ª–∞—Å:</label>
                    <select id="grade">
                        <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–ª–∞—Å</option>
                        <option value="1">1 –∫–ª–∞—Å</option>
                        <option value="2">2 –∫–ª–∞—Å</option>
                        <option value="3">3 –∫–ª–∞—Å</option>
                        <option value="4">4 –∫–ª–∞—Å</option>
                        <option value="5">5 –∫–ª–∞—Å</option>
                        <option value="6">6 –∫–ª–∞—Å</option>
                        <option value="7">7 –∫–ª–∞—Å</option>
                        <option value="8">8 –∫–ª–∞—Å</option>
                        <option value="9">9 –∫–ª–∞—Å</option>
                        <option value="10">10 –∫–ª–∞—Å</option>
                        <option value="11">11 –∫–ª–∞—Å</option>
                    </select>

                    <label for="teacher">–í—á–∏—Ç–µ–ª—å:</label>
                    <input type="text" id="teacher" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª–∏">
                </div>

                <div class="form-group">
                    <h3><span class="icon">üìÖ</span> –ß–∞—Å–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</h3>
                    <label for="startDate">–î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∫—É:</label>
                    <input type="date" id="startDate" value="2024-09-02">

                    <label for="endDate">–î–∞—Ç–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∫—É:</label>
                    <input type="date" id="endDate" value="2025-05-30">

                    <label for="lessonsPerWeek">–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Ä–æ–∫—ñ–≤ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å:</label>
                    <select id="lessonsPerWeek">
                        <option value="1">1 —É—Ä–æ–∫</option>
                        <option value="2">2 —É—Ä–æ–∫–∏</option>
                        <option value="3" selected>3 —É—Ä–æ–∫–∏</option>
                        <option value="4">4 —É—Ä–æ–∫–∏</option>
                        <option value="5">5 —É—Ä–æ–∫—ñ–≤</option>
                        <option value="6">6 —É—Ä–æ–∫—ñ–≤</option>
                    </select>

                    <label for="weekdays">–î–Ω—ñ —Ç–∏–∂–Ω—è:</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 5px; margin-bottom: 0;">
                            <input type="checkbox" value="1" class="weekday-checkbox"> –ü–æ–Ω–µ–¥—ñ–ª–æ–∫
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; margin-bottom: 0;">
                            <input type="checkbox" value="2" class="weekday-checkbox"> –í—ñ–≤—Ç–æ—Ä–æ–∫
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; margin-bottom: 0;">
                            <input type="checkbox" value="3" class="weekday-checkbox" checked> –°–µ—Ä–µ–¥–∞
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; margin-bottom: 0;">
                            <input type="checkbox" value="4" class="weekday-checkbox"> –ß–µ—Ç–≤–µ—Ä
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; margin-bottom: 0;">
                            <input type="checkbox" value="5" class="weekday-checkbox" checked> –ü'—è—Ç–Ω–∏—Ü—è
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <h3><span class="icon">üìñ</span> –¢–µ–º–∞—Ç–∏—á–Ω–µ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è</h3>
                    <label for="topics">–¢–µ–º–∏ —É—Ä–æ–∫—ñ–≤ (–ø–æ –æ–¥–Ω—ñ–π –Ω–∞ —Ä—è–¥–æ–∫):</label>
                    <textarea id="topics" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–º–∏ —É—Ä–æ–∫—ñ–≤, –∫–æ–∂–Ω—É –∑ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞:

–í—Å—Ç—É–ø –¥–æ –ø—Ä–µ–¥–º–µ—Ç—É
–û—Å–Ω–æ–≤–Ω—ñ –ø–æ–Ω—è—Ç—Ç—è
–ü–µ—Ä—à–∞ —Ç–µ–º–∞
–î—Ä—É–≥–∞ —Ç–µ–º–∞
–ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1
–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1
..."></textarea>

                    <label for="autoGenerate">
                        <input type="checkbox" id="autoGenerate" style="width: auto; margin-right: 10px;">
                        –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–µ–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø—Ä–µ–¥–º–µ—Ç—É
                    </label>
                </div>

                <div class="form-group">
                    <h3><span class="icon">üéâ</span> –°–≤—è—Ç–∫–æ–≤—ñ –¥–Ω—ñ —Ç–∞ –∫–∞–Ω—ñ–∫—É–ª–∏</h3>
                    <label for="customHolidays">–î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å–≤—è—Ç–∫–æ–≤—ñ –¥–Ω—ñ (—Ñ–æ—Ä–º–∞—Ç: –†–†–†–†-–ú–ú-–î–î –ù–∞–∑–≤–∞):</label>
                    <textarea id="customHolidays" placeholder="2024-12-19 –î–µ–Ω—å —Å–≤—è—Ç–æ–≥–æ –ú–∏–∫–æ–ª–∞—è
2025-01-14 –°—Ç–∞—Ä–∏–π –ù–æ–≤–∏–π —Ä—ñ–∫
2025-02-14 –î–µ–Ω—å —Å–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞"></textarea>

                    <label for="customVacations">–î–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–∞–Ω—ñ–∫—É–ª–∏ (—Ñ–æ—Ä–º–∞—Ç: –†–†–†–†-–ú–ú-–î–î –†–†–†–†-–ú–ú-–î–î –ù–∞–∑–≤–∞):</label>
                    <textarea id="customVacations" placeholder="2024-11-04 2024-11-10 –î–æ–¥–∞—Ç–∫–æ–≤—ñ –æ—Å—ñ–Ω–Ω—ñ –∫–∞–Ω—ñ–∫—É–ª–∏
2025-02-17 2025-02-23 –õ—é—Ç–Ω–µ–≤—ñ –∫–∞–Ω—ñ–∫—É–ª–∏"></textarea>
                </div>
            </div>

            <button class="generate-btn" onclick="generateKTP()">
                <span class="icon">‚ú®</span> –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ö–¢–ü
            </button>
        </div>

        <div class="results-section" id="resultsSection">
            <div class="results-header">
                <h2 class="results-title">–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ-—Ç–µ–º–∞—Ç–∏—á–Ω–µ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è</h2>
                <div class="export-buttons">
                    <button class="export-btn" onclick="copyToClipboard()">
                        <span class="icon">üìã</span> –ö–æ–ø—ñ—é–≤–∞—Ç–∏
                    </button>
                    <button class="export-btn excel" onclick="exportToExcel()">
                        <span class="icon">üìä</span> –ï–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                    <button class="export-btn docx" onclick="exportToDocx()">
                        <span class="icon">üìÑ</span> –ï–∫—Å–ø–æ—Ä—Ç –≤ DOCX
                    </button>
                </div>
            </div>

            <div class="stats" id="stats"></div>

            <div style="overflow-x: auto;">
                <table class="ktp-table" id="ktpTable">
                    <thead>
                        <tr>
                            <th style="width: 80px;">‚Ññ —É—Ä–æ–∫—É</th>
                            <th style="width: 120px;">–î–∞—Ç–∞</th>
                            <th>–¢–µ–º–∞ —É—Ä–æ–∫—É</th>
                            <th style="width: 150px;">–ü—Ä–∏–º—ñ—Ç–∫–∏</th>
                        </tr>
                    </thead>
                    <tbody id="ktpTableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // –£–∫—Ä–∞—ó–Ω—Å—å–∫—ñ —Å–≤—è—Ç–∫–æ–≤—ñ –¥–Ω—ñ 2024-2025
        const holidays = {
            '2024-09-01': '–î–µ–Ω—å –∑–Ω–∞–Ω—å',
            '2024-10-14': '–î–µ–Ω—å –∑–∞—Ö–∏—Å–Ω–∏–∫–∞ –£–∫—Ä–∞—ó–Ω–∏',
            '2024-12-25': '–†—ñ–∑–¥–≤–æ –•—Ä–∏—Å—Ç–æ–≤–µ (–∫–∞—Ç–æ–ª–∏—Ü—å–∫–µ)',
            '2024-12-31': '–ù–æ–≤–∏–π —Ä—ñ–∫ (–∫–∞–Ω—ñ–∫—É–ª–∏)',
            '2025-01-01': '–ù–æ–≤–∏–π —Ä—ñ–∫',
            '2025-01-07': '–†—ñ–∑–¥–≤–æ –•—Ä–∏—Å—Ç–æ–≤–µ (–ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–µ)',
            '2025-03-08': '–ú—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–π –∂—ñ–Ω–æ—á–∏–π –¥–µ–Ω—å',
            '2025-04-20': '–í–µ–ª–∏–∫–¥–µ–Ω—å (–ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–∏–π)',
            '2025-05-01': '–î–µ–Ω—å –ø—Ä–∞—Ü—ñ',
            '2025-05-09': '–î–µ–Ω—å –ø–µ—Ä–µ–º–æ–≥–∏ –Ω–∞–¥ –Ω–∞—Ü–∏–∑–º–æ–º',
            '2025-05-28': '–î–µ–Ω—å –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü—ñ—ó –£–∫—Ä–∞—ó–Ω–∏'
        };

        // –ö–∞–Ω—ñ–∫—É–ª–∏
        const vacations = [
            { start: '2024-10-28', end: '2024-11-03', name: '–û—Å—ñ–Ω–Ω—ñ –∫–∞–Ω—ñ–∫—É–ª–∏' },
            { start: '2024-12-25', end: '2025-01-08', name: '–ó–∏–º–æ–≤—ñ –∫–∞–Ω—ñ–∫—É–ª–∏' },
            { start: '2025-03-24', end: '2025-03-30', name: '–í–µ—Å–Ω—è–Ω—ñ –∫–∞–Ω—ñ–∫—É–ª–∏' }
        ];

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Ç–µ–º–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–µ–¥–º–µ—Ç—ñ–≤
        const subjectTopics = {
            '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞': [
                '–ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –≤–∏–≤—á–µ–Ω–æ–≥–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—É',
                '–ó–≤—É–∫–∏ —ñ –±—É–∫–≤–∏. –ê–ª—Ñ–∞–≤—ñ—Ç',
                '–°–∫–ª–∞–¥. –ù–∞–≥–æ–ª–æ—Å',
                '–ì–æ–ª–æ—Å–Ω—ñ –∑–≤—É–∫–∏',
                '–ü—Ä–∏–≥–æ–ª–æ—Å–Ω—ñ –∑–≤—É–∫–∏',
                '–°–ª–æ–≤–æ —ñ –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è',
                '–†–µ—á–µ–Ω–Ω—è',
                '–¢–µ–∫—Å—Ç',
                '–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1',
                '–†–æ–±–æ—Ç–∞ –Ω–∞–¥ –ø–æ–º–∏–ª–∫–∞–º–∏'
            ],
            '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞': [
                '–ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –≤–∏–≤—á–µ–Ω–æ–≥–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—É',
                '–ß–∏—Å–ª–∞ –≤—ñ–¥ 1 –¥–æ 100',
                '–î–æ–¥–∞–≤–∞–Ω–Ω—è —ñ –≤—ñ–¥–Ω—ñ–º–∞–Ω–Ω—è',
                '–ú–Ω–æ–∂–µ–Ω–Ω—è —ñ –¥—ñ–ª–µ–Ω–Ω—è',
                '–ó–∞–¥–∞—á—ñ –Ω–∞ –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Å—É–º–∏',
                '–ó–∞–¥–∞—á—ñ –Ω–∞ –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ü—ñ',
                '–ì–µ–æ–º–µ—Ç—Ä–∏—á–Ω—ñ —Ñ—ñ–≥—É—Ä–∏',
                '–û–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è',
                '–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1',
                '–†–æ–±–æ—Ç–∞ –Ω–∞–¥ –ø–æ–º–∏–ª–∫–∞–º–∏'
            ],
            '–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞': [
                '–ó–Ω–∞–π–æ–º—Å—Ç–≤–æ. –ü—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è',
                '–ê–ª—Ñ–∞–≤—ñ—Ç',
                '–ß–∏—Å–ª–∞ –≤—ñ–¥ 1 –¥–æ 10',
                '–ö–æ–ª—å–æ—Ä–∏',
                '–°—ñ–º\'—è',
                '–®–∫–æ–ª–∞',
                '–Ü–≥—Ä–∞—à–∫–∏',
                '–¢–≤–∞—Ä–∏–Ω–∏',
                '–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1',
                '–†–æ–±–æ—Ç–∞ –Ω–∞–¥ –ø–æ–º–∏–ª–∫–∞–º–∏'
            ]
        };

        // –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É –ø—Ä–µ–¥–º–µ—Ç—É
        document.getElementById('subject').addEventListener('change', function() {
            const customSubjectLabel = document.getElementById('customSubjectLabel');
            const customSubjectInput = document.getElementById('customSubject');
            const autoGenerate = document.getElementById('autoGenerate');
            
            if (this.value === '–Ü–Ω—à–∏–π') {
                customSubjectLabel.style.display = 'block';
                customSubjectInput.style.display = 'block';
                autoGenerate.checked = false;
                autoGenerate.disabled = true;
            } else {
                customSubjectLabel.style.display = 'none';
                customSubjectInput.style.display = 'none';
                autoGenerate.disabled = false;
            }
        });

        // –û–±—Ä–æ–±–∫–∞ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–µ–º
        document.getElementById('autoGenerate').addEventListener('change', function() {
            const subject = document.getElementById('subject').value;
            const topicsTextarea = document.getElementById('topics');
            
            if (this.checked && subjectTopics[subject]) {
                topicsTextarea.value = subjectTopics[subject].join('\n');
            } else if (!this.checked) {
                topicsTextarea.value = '';
            }
        });

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–Ω—ñ–≤ —Ç–∏–∂–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É—Ä–æ–∫—ñ–≤
        document.getElementById('lessonsPerWeek').addEventListener('change', function() {
            const lessonsPerWeek = parseInt(this.value);
            const checkboxes = document.querySelectorAll('.weekday-checkbox');
            
            // –°–ø–æ—á–∞—Ç–∫—É –∑–Ω—ñ–º–∞—î–º–æ –≤—Å—ñ –≥–∞–ª–æ—á–∫–∏
            checkboxes.forEach(cb => cb.checked = false);
            
            // –°—Ç–∞–≤–∏–º–æ –≥–∞–ª–æ—á–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É—Ä–æ–∫—ñ–≤
            for (let i = 0; i < Math.min(lessonsPerWeek, checkboxes.length); i++) {
                checkboxes[i].checked = true;
            }
        });

        function isWeekend(date) {
            const day = date.getDay();
            return day === 0 || day === 6; // –Ω–µ–¥—ñ–ª—è –∞–±–æ —Å—É–±–æ—Ç–∞
        }

        function isHoliday(dateStr, customHolidays = {}) {
            return holidays[dateStr] || customHolidays[dateStr];
        }

        function isVacation(date, customVacations = []) {
            const dateStr = date.toISOString().split('T')[0];
            const allVacations = [...vacations, ...customVacations];
            return allVacations.find(vacation => 
                dateStr >= vacation.start && dateStr <= vacation.end
            );
        }

        function parseCustomHolidays(text) {
            const customHolidays = {};
            if (!text.trim()) return customHolidays;
            
            const lines = text.split('\n').filter(line => line.trim());
            lines.forEach(line => {
                const match = line.match(/^(\d{4}-\d{2}-\d{2})\s+(.+)$/);
                if (match) {
                    customHolidays[match[1]] = match[2];
                }
            });
            return customHolidays;
        }

        function parseCustomVacations(text) {
            const customVacations = [];
            if (!text.trim()) return customVacations;
            
            const lines = text.split('\n').filter(line => line.trim());
            lines.forEach(line => {
                const match = line.match(/^(\d{4}-\d{2}-\d{2})\s+(\d{4}-\d{2}-\d{2})\s+(.+)$/);
                if (match) {
                    customVacations.push({
                        start: match[1],
                        end: match[2],
                        name: match[3]
                    });
                }
            });
            return customVacations;
        }

        function formatDate(date) {
            return date.toLocaleDateString('uk-UA', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }

        function generateKTP() {
            console.log('=== –ü–û–ß–ê–¢–û–ö –ì–ï–ù–ï–†–ê–¶–Ü–á –ö–¢–ü ===');
            
            // –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ –∑ —Ñ–æ—Ä–º–∏
            const subjectSelect = document.getElementById('subject').value;
            const customSubject = document.getElementById('customSubject').value;
            const subject = subjectSelect === '–Ü–Ω—à–∏–π' ? customSubject : subjectSelect;
            const grade = document.getElementById('grade').value;
            const teacher = document.getElementById('teacher').value || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ';
            const startDateInput = document.getElementById('startDate').value;
            const endDateInput = document.getElementById('endDate').value;
            const lessonsPerWeek = parseInt(document.getElementById('lessonsPerWeek').value);
            const topicsText = document.getElementById('topics').value;
            const customHolidaysText = document.getElementById('customHolidays').value;
            const customVacationsText = document.getElementById('customVacations').value;

            // –ü–∞—Ä—Å–∏–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —Å–≤—è—Ç–∫–æ–≤—ñ –¥–Ω—ñ —Ç–∞ –∫–∞–Ω—ñ–∫—É–ª–∏
            const customHolidays = parseCustomHolidays(customHolidaysText);
            const customVacations = parseCustomVacations(customVacationsText);

            console.log('–î–∞–Ω—ñ —Ñ–æ—Ä–º–∏:', { 
                subjectSelect, 
                customSubject, 
                subject, 
                grade, 
                startDateInput, 
                endDateInput, 
                lessonsPerWeek,
                topicsLength: topicsText.length,
                customHolidays,
                customVacations
            });

            // –î–µ—Ç–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–ª—ñ–≤
            if (!subject || subject.trim() === '') {
                alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –∞–±–æ –≤–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –ø—Ä–µ–¥–º–µ—Ç—É!');
                return;
            }
            
            if (!grade || grade === '') {
                alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –∫–ª–∞—Å!');
                return;
            }

            if (!startDateInput || !endDateInput) {
                alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∫–∞–∂—ñ—Ç—å –¥–∞—Ç–∏ –ø–æ—á–∞—Ç–∫—É —Ç–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∫—É!');
                return;
            }

            const startDate = new Date(startDateInput);
            const endDate = new Date(endDateInput);

            console.log('–î–∞—Ç–∏:', { startDate, endDate });

            if (startDate >= endDate) {
                alert('‚ùå –î–∞—Ç–∞ –ø–æ—á–∞—Ç–∫—É –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ —Ä–∞–Ω—ñ—à–µ –¥–∞—Ç–∏ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è!');
                return;
            }

            // –û—Ç—Ä–∏–º—É—î–º–æ –≤–∏–±—Ä–∞–Ω—ñ –¥–Ω—ñ —Ç–∏–∂–Ω—è
            const checkboxes = document.querySelectorAll('.weekday-checkbox:checked');
            console.log('–ó–Ω–∞–π–¥–µ–Ω–æ —á–µ–∫–±–æ–∫—Å—ñ–≤:', checkboxes.length);
            
            const selectedWeekdays = Array.from(checkboxes).map(cb => {
                const value = parseInt(cb.value);
                console.log('–ß–µ–∫–±–æ–∫—Å –∑–Ω–∞—á–µ–Ω–Ω—è:', value);
                return value;
            });

            console.log('–í–∏–±—Ä–∞–Ω—ñ –¥–Ω—ñ —Ç–∏–∂–Ω—è (raw):', selectedWeekdays);

            if (selectedWeekdays.length === 0) {
                alert('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –¥–Ω—ñ —Ç–∏–∂–Ω—è –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è —É—Ä–æ–∫—ñ–≤!');
                return;
            }

            // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–º–∏
            let topics = [];
            if (topicsText.trim()) {
                topics = topicsText.split('\n').filter(topic => topic.trim() !== '');
                console.log('–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≤–≤–µ–¥–µ–Ω—ñ —Ç–µ–º–∏:', topics.length);
            } else if (subjectTopics[subject]) {
                topics = [...subjectTopics[subject]];
                // –î–æ–¥–∞—î–º–æ —â–µ —Ç–µ–º –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∫—É
                const baseCount = topics.length;
                for (let i = baseCount + 1; i <= 50; i++) {
                    topics.push(`–î–æ–¥–∞—Ç–∫–æ–≤–∞ —Ç–µ–º–∞ ${i - baseCount}`);
                }
                console.log('–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≥–æ—Ç–æ–≤—ñ —Ç–µ–º–∏ –¥–ª—è –ø—Ä–µ–¥–º–µ—Ç—É:', subject, topics.length);
            } else {
                // –°—Ç–≤–æ—Ä—é—î–º–æ –±–∞–∑–æ–≤—ñ —Ç–µ–º–∏
                for (let i = 1; i <= 50; i++) {
                    topics.push(`–£—Ä–æ–∫ ${i}. –¢–µ–º–∞ ${i}`);
                }
                console.log('–°—Ç–≤–æ—Ä–µ–Ω–æ –±–∞–∑–æ–≤—ñ —Ç–µ–º–∏:', topics.length);
            }

            // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ä–æ–∑–∫–ª–∞–¥
            const schedule = [];
            let currentDate = new Date(startDate);
            let lessonNumber = 1;
            let topicIndex = 0;
            let daysProcessed = 0;
            const maxDays = 365; // –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª—É

            console.log('–ü–æ—á–∞—Ç–æ–∫ —Ü–∏–∫–ª—É –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó...');

            while (currentDate <= endDate && topicIndex < topics.length && daysProcessed < maxDays) {
                daysProcessed++;
                const dayOfWeek = currentDate.getDay(); // 0=–Ω–µ–¥—ñ–ª—è, 1=–ø–æ–Ω–µ–¥—ñ–ª–æ–∫...
                const dateStr = currentDate.toISOString().split('T')[0];

                if (daysProcessed <= 10) {
                    console.log(`–î–µ–Ω—å ${daysProcessed}: ${currentDate.toDateString()}, –¥–µ–Ω—å —Ç–∏–∂–Ω—è: ${dayOfWeek}, –≤–∏–±—Ä–∞–Ω—ñ –¥–Ω—ñ: ${selectedWeekdays}`);
                }

                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Ü–µ –≤–∏–±—Ä–∞–Ω–∏–π –¥–µ–Ω—å —Ç–∏–∂–Ω—è
                if (selectedWeekdays.includes(dayOfWeek)) {
                    const vacation = isVacation(currentDate, customVacations);
                    const holiday = isHoliday(dateStr, customHolidays);

                    if (vacation) {
                        schedule.push({
                            lessonNumber: '-',
                            date: formatDate(currentDate),
                            topic: vacation.name,
                            notes: '–ö–∞–Ω—ñ–∫—É–ª–∏',
                            isVacation: true
                        });
                        console.log('–î–æ–¥–∞–Ω–æ –∫–∞–Ω—ñ–∫—É–ª–∏:', vacation.name);
                    } else if (holiday) {
                        schedule.push({
                            lessonNumber: '-',
                            date: formatDate(currentDate),
                            topic: holiday,
                            notes: '–°–≤—è—Ç–∫–æ–≤–∏–π –¥–µ–Ω—å',
                            isHoliday: true
                        });
                        console.log('–î–æ–¥–∞–Ω–æ —Å–≤—è—Ç–æ:', holiday);
                    } else {
                        schedule.push({
                            lessonNumber: lessonNumber++,
                            date: formatDate(currentDate),
                            topic: topics[topicIndex++],
                            notes: ''
                        });
                        if (schedule.length <= 5) {
                            console.log('–î–æ–¥–∞–Ω–æ —É—Ä–æ–∫:', lessonNumber - 1, topics[topicIndex - 1]);
                        }
                    }
                }

                currentDate.setDate(currentDate.getDate() + 1);
            }

            console.log('=== –†–ï–ó–£–õ–¨–¢–ê–¢ –ì–ï–ù–ï–†–ê–¶–Ü–á ===');
            console.log('–í—Å—å–æ–≥–æ –∑–∞–ø–∏—Å—ñ–≤ —É —Ä–æ–∑–∫–ª–∞–¥—ñ:', schedule.length);
            console.log('–î–Ω—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ:', daysProcessed);
            console.log('–£—Ä–æ–∫—ñ–≤ —Å—Ç–≤–æ—Ä–µ–Ω–æ:', schedule.filter(s => s.lessonNumber !== '-').length);

            if (schedule.length === 0) {
                alert('‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥!\n\n–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:\n- –ß–∏ –æ–±—Ä–∞–Ω—ñ –¥–Ω—ñ —Ç–∏–∂–Ω—è\n- –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –¥–∞—Ç–∏\n- –ß–∏ —î —Ç–µ–º–∏ –¥–ª—è —É—Ä–æ–∫—ñ–≤');
                return;
            }

            // –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
            displayResults(schedule, subject, grade, teacher);
            alert('‚úÖ –ö–¢–ü —É—Å–ø—ñ—à–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ!');
        }

        function displayResults(schedule, subject, grade, teacher) {
            const resultsSection = document.getElementById('resultsSection');
            const ktpTableBody = document.getElementById('ktpTableBody');
            const statsDiv = document.getElementById('stats');

            // –û—á–∏—â—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é
            ktpTableBody.innerHTML = '';

            // –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Ç–∞–±–ª–∏—Ü—é
            schedule.forEach(lesson => {
                const row = document.createElement('tr');
                
                if (lesson.isVacation) {
                    row.className = 'weekend-row';
                } else if (lesson.isHoliday) {
                    row.className = 'holiday-row';
                }

                row.innerHTML = `
                    <td style="text-align: center;">
                        ${lesson.lessonNumber !== '-' ? 
                            `<div class="lesson-number">${lesson.lessonNumber}</div>` : 
                            '-'
                        }
                    </td>
                    <td>${lesson.date}</td>
                    <td>${lesson.topic}</td>
                    <td>${lesson.notes}</td>
                `;

                ktpTableBody.appendChild(row);
            });

            // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const totalLessons = schedule.filter(l => l.lessonNumber !== '-').length;
            const holidays = schedule.filter(l => l.isHoliday).length;
            const vacationDays = schedule.filter(l => l.isVacation).length;
            const totalDays = schedule.length;

            // –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            statsDiv.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalLessons}</div>
                    <div class="stat-label">–í—Å—å–æ–≥–æ —É—Ä–æ–∫—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${holidays}</div>
                    <div class="stat-label">–°–≤—è—Ç–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${vacationDays}</div>
                    <div class="stat-label">–ö–∞–Ω—ñ–∫—É–ª—è—Ä–Ω–∏—Ö –¥–Ω—ñ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${totalDays}</div>
                    <div class="stat-label">–í—Å—å–æ–≥–æ –¥–Ω—ñ–≤</div>
                </div>
            `;

            // –û–Ω–æ–≤–ª—é—î–º–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫
            document.querySelector('.results-title').textContent = 
                `–ö–¢–ü –∑ –ø—Ä–µ–¥–º–µ—Ç—É "${subject}" –¥–ª—è ${grade} –∫–ª–∞—Å—É`;

            // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
            resultsSection.style.display = 'block';
            resultsSection.scrollIntoView({ behavior: 'smooth' });

            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É
            window.ktpData = {
                schedule,
                subject,
                grade,
                teacher,
                totalLessons,
                holidays,
                vacationDays
            };
        }

        function copyToClipboard() {
            const table = document.getElementById('ktpTable');
            const range = document.createRange();
            range.selectNode(table);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            
            try {
                document.execCommand('copy');
                alert('–¢–∞–±–ª–∏—Ü—é —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É!');
            } catch (err) {
                alert('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è. –°–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–±—Ä–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é –≤—Ä—É—á–Ω—É.');
            }
            
            window.getSelection().removeAllRanges();
        }

        function exportToExcel() {
            if (!window.ktpData) {
                alert('–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ –ö–¢–ü!');
                return;
            }

            try {
                const { schedule, subject, grade, teacher } = window.ktpData;

                // –°—Ç–≤–æ—Ä—é—î–º–æ CSV –∫–æ–Ω—Ç–µ–Ω—Ç
                let csvContent = '\uFEFF'; // BOM –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤
                csvContent += `–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ-—Ç–µ–º–∞—Ç–∏—á–Ω–µ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è\n`;
                csvContent += `–ü—Ä–µ–¥–º–µ—Ç:,"${subject}"\n`;
                csvContent += `–ö–ª–∞—Å:,"${grade}"\n`;
                csvContent += `–í—á–∏—Ç–µ–ª—å:,"${teacher}"\n`;
                csvContent += `–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:,"${new Date().toLocaleDateString('uk-UA')}"\n\n`;
                
                csvContent += '"‚Ññ —É—Ä–æ–∫—É","–î–∞—Ç–∞","–¢–µ–º–∞ —É—Ä–æ–∫—É","–ü—Ä–∏–º—ñ—Ç–∫–∏"\n';
                
                schedule.forEach(lesson => {
                    const lessonNum = lesson.lessonNumber === '-' ? '' : lesson.lessonNumber;
                    const topic = lesson.topic.replace(/"/g, '""'); // –ï–∫—Ä–∞–Ω—É—î–º–æ –ª–∞–ø–∫–∏
                    const notes = lesson.notes.replace(/"/g, '""');
                    csvContent += `"${lessonNum}","${lesson.date}","${topic}","${notes}"\n`;
                });

                // –°—Ç–≤–æ—Ä—é—î–º–æ —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–∞–π–ª
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `–ö–¢–ü_${subject.replace(/[^\w\s]/gi, '')}_${grade}–∫–ª–∞—Å.csv`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                URL.revokeObjectURL(url);
                alert('‚úÖ –§–∞–π–ª CSV —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!');
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –µ–∫—Å–ø–æ—Ä—Ç—É:', error);
                alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç—ñ —Ñ–∞–π–ª—É');
            }
        }

        function exportToDocx() {
            if (!window.ktpData) {
                alert('–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ –ö–¢–ü!');
                return;
            }

            try {
                const { schedule, subject, grade, teacher } = window.ktpData;

                // –°—Ç–≤–æ—Ä—é—î–º–æ HTML –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è DOCX
                let htmlContent = `
                    <html>
                    <head>
                        <meta charset="utf-8">
                        <title>–ö–¢–ü ${subject} ${grade} –∫–ª–∞—Å</title>
                        <style>
                            body { font-family: 'Times New Roman', serif; font-size: 12pt; }
                            h1 { text-align: center; font-size: 16pt; margin-bottom: 20px; }
                            .info { margin-bottom: 20px; }
                            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                            th, td { border: 1px solid black; padding: 8px; text-align: left; }
                            th { background-color: #f0f0f0; font-weight: bold; }
                            .lesson-number { text-align: center; font-weight: bold; }
                            .holiday { background-color: #ffe6e6; font-style: italic; }
                            .vacation { background-color: #e6f7ff; font-style: italic; }
                        </style>
                    </head>
                    <body>
                        <h1>–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ-—Ç–µ–º–∞—Ç–∏—á–Ω–µ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è</h1>
                        <div class="info">
                            <p><strong>–ü—Ä–µ–¥–º–µ—Ç:</strong> ${subject}</p>
                            <p><strong>–ö–ª–∞—Å:</strong> ${grade}</p>
                            <p><strong>–í—á–∏—Ç–µ–ª—å:</strong> ${teacher}</p>
                            <p><strong>–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:</strong> ${new Date().toLocaleDateString('uk-UA')}</p>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 10%;">‚Ññ —É—Ä–æ–∫—É</th>
                                    <th style="width: 15%;">–î–∞—Ç–∞</th>
                                    <th style="width: 60%;">–¢–µ–º–∞ —É—Ä–æ–∫—É</th>
                                    <th style="width: 15%;">–ü—Ä–∏–º—ñ—Ç–∫–∏</th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                schedule.forEach(lesson => {
                    const rowClass = lesson.isHoliday ? 'holiday' : (lesson.isVacation ? 'vacation' : '');
                    const lessonNum = lesson.lessonNumber === '-' ? '' : lesson.lessonNumber;
                    
                    htmlContent += `
                        <tr class="${rowClass}">
                            <td class="lesson-number">${lessonNum}</td>
                            <td>${lesson.date}</td>
                            <td>${lesson.topic}</td>
                            <td>${lesson.notes}</td>
                        </tr>
                    `;
                });

                htmlContent += `
                            </tbody>
                        </table>
                    </body>
                    </html>
                `;

                // –°—Ç–≤–æ—Ä—é—î–º–æ blob –∑ HTML –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
                const blob = new Blob([htmlContent], { 
                    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' 
                });
                
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `–ö–¢–ü_${subject.replace(/[^\w\s]/gi, '')}_${grade}–∫–ª–∞—Å.docx`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                URL.revokeObjectURL(url);
                alert('‚úÖ –§–∞–π–ª DOCX —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n–ü—Ä–∏–º—ñ—Ç–∫–∞: –§–∞–π–ª –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ HTML, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –≤ Microsoft Word.');
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –µ–∫—Å–ø–æ—Ä—Ç—É DOCX:', error);
                alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç—ñ —Ñ–∞–π–ª—É DOCX');
            }
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –¥–∞—Ç–∏ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∫—É
            const today = new Date();
            const currentYear = today.getFullYear();
            
            // –Ø–∫—â–æ –∑–∞—Ä–∞–∑ –ø—ñ—Å–ª—è —á–µ—Ä–≤–Ω—è, —Ç–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –Ω–∞–≤—á–∞–ª—å–Ω–∏–π —Ä—ñ–∫
            const schoolYear = today.getMonth() >= 6 ? currentYear : currentYear - 1;
            
            const startDate = new Date(schoolYear, 8, 2); // 2 –≤–µ—Ä–µ—Å–Ω—è
            const endDate = new Date(schoolYear + 1, 4, 30); // 30 —Ç—Ä–∞–≤–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä–æ–∫—É
            
            document.getElementById('startDate').value = startDate.toISOString().split('T')[0];
            document.getElementById('endDate').value = endDate.toISOString().split('T')[0];
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ea30868458ca2d',t:'MTc1NTEwODgzOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
